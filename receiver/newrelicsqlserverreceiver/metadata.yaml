type: newrelicsqlserver

status:
  class: receiver
  stability:
    alpha: [metrics]
  distributions: [contrib]
  codeowners:
    active: [tanushangural]

resource_attributes:
  server.address:
    description: SQL Server hostname or IP address
    type: string
    enabled: true
  server.port:
    description: SQL Server port number
    type: string
    enabled: true
  db.system:
    description: Database system identifier
    type: string
    enabled: true
    default: mssql

metrics:
  sqlserver.buffer.cache_hit_ratio:
    enabled: true
    description: Buffer cache hit ratio percentage
    unit: "%"
    gauge:
      value_type: double
  
  sqlserver.buffer.page_life_expectancy:
    enabled: true
    description: Page life expectancy in seconds
    unit: "s"
    gauge:
      value_type: int
  
  sqlserver.connections.user:
    enabled: true
    description: Number of user connections
    unit: "{connections}"
    gauge:
      value_type: int
  
  sqlserver.memory.total:
    enabled: true
    description: Total server memory in KB
    unit: "kBy"
    gauge:
      value_type: int
  
  sqlserver.memory.target:
    enabled: true
    description: Target server memory in KB
    unit: "kBy"
    gauge:
      value_type: int

  # Lock Resource Metrics (what's being locked)
  sqlserver.lock.resource.total:
    enabled: true
    description: Total active locks in the database
    unit: "1"
    gauge:
      value_type: int
  
  sqlserver.lock.resource.table:
    enabled: true
    description: Number of table-level locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.page:
    enabled: true
    description: Number of page-level locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.row:
    enabled: true
    description: Number of row-level locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.key:
    enabled: true
    description: Number of key-level locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.extent:
    enabled: true
    description: Number of extent-level locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.database_level:
    enabled: true
    description: Number of database-level locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.file:
    enabled: true
    description: Number of file-level locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.application:
    enabled: true
    description: Number of application locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.metadata:
    enabled: true
    description: Number of metadata locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.hobt:
    enabled: true
    description: Number of heap or B-tree locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.resource.allocation_unit:
    enabled: true
    description: Number of allocation unit locks
    unit: "1"
    gauge:
      value_type: int

  # Lock Mode Metrics (how it's locked)
  sqlserver.lock.mode.total:
    enabled: true
    description: Total active locks by mode
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.mode.shared:
    enabled: true
    description: Number of shared locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.mode.exclusive:
    enabled: true
    description: Number of exclusive locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.mode.update:
    enabled: true
    description: Number of update locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.mode.intent:
    enabled: true
    description: Number of intent locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.mode.schema:
    enabled: true
    description: Number of schema locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.mode.bulk_update:
    enabled: true
    description: Number of bulk update locks
    unit: "1"
    gauge:
      value_type: int
      
  sqlserver.lock.mode.shared_intent_exclusive:
    enabled: true
    description: Number of shared intent exclusive locks
    unit: "1"
    gauge:
      value_type: int

tests:
  config:
    hostname: "localhost"
    port: "1433"
    username: "test_user"
    password: "test_password"
    collection_interval: 15s
